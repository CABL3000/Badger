<!--
  To change this template, choose Tools | Templates
  and open the template in the editor.
-->

<%@ page contentType="text/html;charset=UTF-8" %>

<html>
  <head>
    <meta name='layout' content='main'/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>UniGene Info</title>
    <parameter name="search" value="selected"></parameter>
  </head>
  <body>
  <g:if test="${info_results}">
    <h1>Stats for UniGene <b>${info_results.contig_id[0]}</b>:</h1>
    <table>
      <tr>
        <td><b>Length</b></td>
        <td><b>Coverage</b></td>
        <td><b>Sequence</b></td>
      </tr>
      <tr>
        <td>${info_results.sequence[0].length()}</td>
        <td>${info_results.coverage[0]}</td>
        <td><g:link controller="FileDownload" action="contig_download" params="${[fileId : nuc_fasta, fileName: info_results.contig_id[0]+'.fa']}">Download</g:link></td>
      </tr>
    </table>
    <div class="midtable">
    <table><tr>
    <td><strong>${resCount}</strong> annotations for ${info_results.contig_id[0]}:</td>
    <td>Showing results ${offint} - ${sum}</td>
    <td><g:paginate next="Next" prev="Previous" maxsteps="10" controller="search" action="unigene_info" total="${resCount}" params="${[contig_id:info_results.contig_id[0]]}"/></td>
    </tr></table>       
    </div>
    <table>
      <tr>
        <td><b>Database</b></td>
        <td><b>Hit ID</b></td>
        <td><b>Description</b></td>
        <td><b>Start</b></td>
        <td><b>Stop</b></td>
        <td><b>Score</b></td>
      </tr>
     <g:each var="res" in="${anno_results}">
      <tr>  
        <td>${res.anno_db}</td>
        <%
        res.anno_id = res.anno_id.replaceAll(/\|([A-Z0-9]*[A-Z0-9]*[A-Z0-9]*[A-Z0-9]*[A-Z0-9]*[A-Z0-9])\|/, "<a href=\"http://www.ncbi.nlm.nih.gov/protein/\$1\" target=\'_blank\'>|\$1|</a>") 
        res.descr = res.descr.replaceAll(/\|([A-Z0-9]*[A-Z0-9]*[A-Z0-9]*[A-Z0-9]*[A-Z0-9]*[A-Z0-9])\|/, "<a href=\"http://www.ncbi.nlm.nih.gov/protein/\$1\" target=\'_blank\'>|\$1|</a>") 
        %>
        <td>${res.anno_id}</td>
        <td>${res.descr}</td>
        <td>${res.anno_start}</td>
        <td>${res.anno_stop}</td>
        <td>${res.score}</td>
      </tr>  
     </g:each>
    </table>
  </g:if>
  <g:else>
    <h1>The gene Id has no information</h1>
  </g:else>
  </body>
</html>
